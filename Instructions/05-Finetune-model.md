---
lab:
  title: Azure AI Studio でのチャット入力候補用に言語モデルを微調整する
---

# Azure AI Studio でのチャット入力候補用に言語モデルを微調整する

この演習では、カスタム Copilot のシナリオに使用する、Azure AI Studio での言語モデルを微調整します。

この演習には約 **45** 分かかります。

## Azure AI Studio の中で AI ハブとプロジェクトを作成する

まずは、次のように Azure AI ハブの中で Azure AI Studio プロジェクトを作成します。

1. Web ブラウザーで [https://ai.azure.com](https://ai.azure.com) を開き、Azure の資格情報を使ってサインインします。
1. **[ホーム]** ページを選択してから、**[+ 新しいプロジェクト]** を選択します。
1. **[新しいプロジェクトの作成]** ウィザードで、次の設定を使ってプロジェクトを作成します。
    - **プロジェクト名**:"プロジェクトの一意の名前"**
    - **ハブ**:次の設定で新しいハブを作成します。**
        - **ハブ名**:*一意の名前*
        - **[サブスクリプション]**:"*ご自身の Azure サブスクリプション*"
        - **[リソース グループ]**: "新しいリソース グループ"**
        - **[場所]**: *以下のいずれかのリージョンから**ランダム**に選択する*\*
        - 米国東部 2
        - 米国中北部
        - スウェーデン中部
        - スイス北部
    - **Azure AI サービスまたは Azure OpenAI への接続**:*新しい接続を作成する*
    - **Azure AI 検索への接続**:接続をスキップする

    > \* Azure OpenAI リソースは、リージョンのクォータによってテナント レベルで制限されます。 一覧表示されているリージョンには、この演習で使用されるモデル タイプの既定のクォータが含まれています。 リージョンをランダムに選択すると、1 つのリージョンがクォータ制限に達するリスクが軽減されます。 演習の後半でクォータ制限に達した場合は、別のリージョンに別のリソースを作成する必要が生じる可能性があります。 詳しくは、[リージョンごとのモデルの可用性](https://learn.microsoft.com/en-us/azure/ai-studio/concepts/fine-tuning-overview#azure-openai-models)を参照してください

1. 構成を確認して、プロジェクトを作成します。
1. プロジェクトが作成されるまで待ちます。

## GPT-3.5 モデルを微調整する

モデルを微調整する前に、データセットが必要です。

1. トレーニング データセットを JSONL ファイルでローカルに保存します: https://raw.githubusercontent.com/MicrosoftLearning/mslearn-ai-studio/main/data/travel-finetune.jsonl
1. 左側のメニューを使用して、**[ツール]** セクションの **[微調整]** ページに移動します。
1. 新しい微調整モデルを追加するボタンを選択し、`gpt-35-turbo` モデルを選択して、**[確認]** を選択します。
1. 次の構成を使用してモデルを**微調整**します。
    - **モデルのバージョン**: *Select the default version (既定のバージョンの選択)*
    - **[モデル サフィックス]**: `ft-travel`
    - **[Azure OpenAI 接続]**: *ハブの作成時に作成された接続を選択します*
    - **[トレーニング データ]**: ファイルをアップロードします
    - **[ファイルのアップロード]**: 前の手順でダウンロードした JSONL ファイルを選択します。

    > **ヒント**: 次の手順に進むのに、データ処理が完了するのを待つ必要はありません。

    - **[検証データ]**: なし
    - **[タスク パラメーター]**: *既定の設定のままにします*
1. 微調整が開始されます。完了するまでに時間がかかる場合があります。

> **注**: 微調整とデプロイには時間がかかる可能性があるため、次の手順を完了するのに、定期的に終了の確認をする必要がある場合があります。

## 微調整されたモデルをデプロイする

微調整が正常に完了したら、モデルをデプロイできます。

1. 微調整されたモデルを選択します。 **[メトリック]** タブを選択し、微調整されたメトリックを調べます。
1. 次の構成を使用して、微調整されたモデルをデプロイします。
    - **[デプロイ名]**: *モデルの一意の名前、既定値を使用できます*
    - **デプロイの種類**:Standard
    - **1 分あたりのトークン数のレート制限 (1,000 単位)**:5,000
    - **コンテンツ フィルター**: 既定

## 微調整したモデルをテストする

微調整したモデルをデプロイしたので、デプロイした他のモデルをテストするのと同様に、このモデルをテストできます。

1. デプロイの準備ができたら、微調整したモデルに移動し、**[プレイグラウンドで開く]** を選択します。
1. チャット ウィンドウで、旅行関連の質問に回答するようにモデルに指示するシステム メッセージを指定していない場合でも、注目すべきことをモデルが既に理解していることがわかる、クエリ `What can you do?` を入力します。
1. `Where should I go on holiday for my 30th birthday?` のような別のクエリを試します。

## クリーンアップ

Azure AI Studio を調べ終わったら、Azure の不要なコストを避けるため、作成したリソースを削除する必要があります。

- [Azure portal](https://portal.azure.com) (`https://portal.azure.com`) に移動します。
- Azure portal の **[ホーム]** ページで、**[リソース グループ]** を選択します。
- この演習のために作成したリソース グループを選びます。
- リソース グループの **[概要]** ページの上部で、**[リソース グループの削除]** を選択します。
- リソース グループ名を入力して、削除することを確認し、**[削除]** を選択します。
