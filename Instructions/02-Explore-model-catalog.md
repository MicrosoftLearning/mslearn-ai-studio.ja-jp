---
lab:
  title: 言語モデルを選択してデプロイする
  description: 生成 AI アプリケーションは、1 つ以上の言語モデルに基づいて構築されます。 自分の生成 AI プロジェクトに適したモデルを見つけて選択する方法について説明します。
---

# 言語モデルを選択してデプロイする

Azure AI Foundry のモデル カタログは、さまざまなモデルを試してから使用できる中央リポジトリとして機能し、生成 AI シナリオの作成を容易にします。

この演習では、Azure AI Foundry ポータルでモデル カタログを調べて、問題の解決に役立つ生成 AI アプリケーション用に使用可能なモデルを比較します。

この演習には、約 **25** 分かかります。

> **注**: この演習で使用されるテクノロジの一部は、プレビューの段階または開発中の段階です。 予期しない動作、警告、またはエラーが発生する場合があります。

## モデルを調査する

まず、Azure AI Foundry ポータルにサインインし、使用可能なモデルの一部を調べてみましょう。

1. Web ブラウザーで [Azure AI Foundry ポータル](https://ai.azure.com) (`https://ai.azure.com`) を開き、Azure 資格情報を使用してサインインします。 初めてサインインするときに開いたヒントまたはクイック スタート ウィンドウを閉じます。また、必要に応じて左上にある **Azure AI Foundry** ロゴを使用してホーム ページに移動します。それは次の画像のようになります (**[ヘルプ]** ウィンドウが開いている場合は閉じます)。

    ![Azure AI Foundry ポータルのスクリーンショット。](./media/ai-foundry-home.png)

1. ホーム ページの情報を確認します。
1. ホーム ページの **[モデルと機能を調査する]** セクションで、プロジェクトで使用する `gpt-4o` モデルを検索します。
1. 検索結果で **gpt-4o** モデルを選んで、その詳細を表示します。
1. 説明を読み、**[詳細]** タブで入手できるその他の情報を確認します。

    ![GPT-4o モデルの詳細ページのスクリーンショット。](./media/gpt4-details.png)

1. **GPT-4o** ページで、**[ベンチマーク]** タブを表示して、一部の標準パフォーマンス ベンチマークと同様のシナリオで使用されている他のモデルとのモデルの比較を確認します。

    ![GPT-4o の [モデル ベンチマーク] ページのスクリーンショット。](./media/gpt4-benchmarks.png)

1. **GPT-4o** ページ タイトルの横にある戻る矢印 (**&larr;**) を使用して、モデル カタログに戻ります。
1. `Phi-3.5-mini-instruct` を検索し、**Phi-3.5-mini-instruct** モデルの詳細とベンチマークを表示します。

## モデルの比較

2 つの異なるモデルを確認しました。どちらも、生成 AI チャット アプリケーションの実装に使用できます。 次に、これら 2 つのモデルのメトリックを視覚的に比較してみましょう。

1. 戻る矢印 (**&larr;**) を使用して、モデル カタログに戻ります。
1. **[モデルの比較]** を選択します。 モデル比較用のビジュアル チャートが、一般的なモデルの選択と共に表示されます。

    ![モデル比較ページのスクリーンショット。](./media/compare-models.png)

1. **[比較するモデル]** ウィンドウで、*質問応答*などの一般的なタスクを選んで、特定のタスクで一般的に使用されるモデルを自動的に選択できることに注意してください。
1. **[すべてのモデルをクリア]** (&128465;) アイコンを使用して、事前に選択したすべてのモデルを削除します。
1. **[+ 比較するモデル]** ボタンを使用して、**GPT-4o** モデルを一覧に追加します。 次に、同じボタンを使用して、**Phi-3.5-mini-instruct** モデルを一覧に追加します。
1. **品質インデックス** (モデルの品質を示す標準化されたスコア) と**コスト**に基づいてモデルを比較しているチャートを確認します。 チャート内でモデルを表すポイントの上にマウスを合わせると、モデルの特定の値を確認できます。

    ![GPT-4o と Phi-3.5-mini-instruct のモデル比較チャートのスクリーンショット。](./media/comparison-chart.png)

1. **X 軸**ドロップダウン メニューの **[品質]** で、次のメトリックを選択し、結果の各グラフを観察してから次に切り替えます。
    - 精度
    - 一貫性
    - 流暢性
    - 関連性

    ベンチマークによれば、gpt-4o モデルは全体的なパフォーマンスが一番高いものの、コストが高いように見えます。

1. 比較するモデルの一覧で **gpt-4o** モデルを選択して、ベンチマーク ページをもう一度開きます。
1. **gpt-4o** モデル ページのページで、**[概要]** タブを選択してモデルの詳細を表示します。

## Azure AI Foundry プロジェクトを作成する

モデルを使用するには、Azure AI Foundry *プロジェクト*を作成する必要があります。

1. **gpt-4o** モデルの概要ページの上部にある **[このモデルを使用する]** を選択します。
1. プロジェクトの作成を求められたら、プロジェクトの有効な名前を入力し、**[詳細]** オプションを展開します。
1. **[詳細オプション]** セクションで、ハブの次の設定を指定します。
    - **Azure AI Foundry リソース**: *Azure AI Foundry リソースの有効な名前*
    - **[サブスクリプション]**:"*ご自身の Azure サブスクリプション*"
    - **リソース グループ**: *リソース グループを作成または選択します*
    - **リージョン**: ***AI サービスでサポートされている場所を選択します***\*

    > \* 一部の Azure AI リソースは、リージョンのモデル クォータによって制限されます。 演習の後半でクォータ制限を超えた場合は、別のリージョンに別のリソースを作成する必要が生じる可能性があります。

1. **[作成]** を選択し、選んだ gpt-4 モデル デプロイを含むプロジェクトが作成されるまで待ちます。
1. プロジェクトが作成されると、モデルをテストできるようにチャットプレイグラウンドが自動的に開かれます。

    ![Azure AI Foundry プロジェクトのチャット プレイグラウンドのスクリーンショット。](./media/ai-foundry-chat-playground.png)

## *GPT-4o* モデルとチャットする

これでモデルのデプロイが完了したので、プレイグラウンドを使用してテストできます。

1. チャット プレイグラウンドの **[セットアップ]** ウィンドウで、**gpt-4o** モデルが選択されていることを確認し、**[モデルに指示とコンテキストを与える]** フィールドで、システム プロンプトを `You are an AI assistant that helps solve problems.` に設定します。
1. **[変更の適用]** を選択して、システム プロンプトを更新します。

1. チャット ウィンドウに次のクエリを入力します

    ```
   I have a fox, a chicken, and a bag of grain that I need to take over a river in a boat. I can only take one thing at a time. If I leave the chicken and the grain unattended, the chicken will eat the grain. If I leave the fox and the chicken unattended, the fox will eat the chicken. How can I get all three things across the river without anything being eaten?
    ```

1. 応答を表示します。 それから、次のフォローアップ クエリを入力します。

    ```
   Explain your reasoning.
    ```

## 別のモデルをデプロイする

プロジェクトを作成すると、選択した **gpt-4o** モデルが自動的にデプロイされました。 検討した ***Phi-3.5-mini-instruct** モデルもデプロイしてみましょう。

1. 左側のナビゲーション バーの **[マイ アセット]** セクションで、**[モデル + エンドポイント]** を選択します。
1. **[モデル デプロイ]** タブの **[+ モデルのデプロイ]** ドロップダウン リストで、**[基本モデルのデプロイ]** を選択します。 次に、`Phi-3.5-mini-instruct` を検索して選択を確認します。
1. モデル ライセンスに同意します。
1. 次の設定で **Phi-3.5-mini-instruct** モデルをデプロイします。
    - **デプロイ名**: モデル デプロイの有効な名前**
    - **デプロイの種類**: グローバル標準
    - **デプロイの詳細**: *既定の設定を使用します*

1. デプロイが完了するまで待ちます。

## *Phi-3.5* モデルとチャットする

それでは、プレイグラウンドで新しいモデルとチャットしましょう。

1. ナビゲーション バーで、**[プレイグラウンド]** を選択します。 次に、**[チャット プレイグラウンド]** を選択します。
1. チャット プレイグラウンドの **[セットアップ]** ウィンドウで、**Phi-3.5-mini-instruct** モデルが選択されていることを確認し、**[モデルに指示とコンテキストを与える]** フィールドで、システム プロンプトを `You are an AI assistant that helps solve problems.` (gpt-4o モデルのテストに使用したシステム プロンプトと同じもの) に設定します。
1. **[変更の適用]** を選択して、システム プロンプトを更新します。
1. GPT-4 モデルのテストに使用したのと同じプロンプトを繰り返す前に、新しいチャット セッションが開始されていることを確認します。
1. チャット ウィンドウに次のクエリを入力します

    ```
   I have a fox, a chicken, and a bag of grain that I need to take over a river in a boat. I can only take one thing at a time. If I leave the chicken and the grain unattended, the chicken will eat the grain. If I leave the fox and the chicken unattended, the fox will eat the chicken. How can I get all three things across the river without anything being eaten?
    ```

1. 応答を表示します。 それから、次のフォローアップ クエリを入力します。

    ```
   Explain your reasoning.
    ```

## さらに比較を実行する

1. **[セットアップ]** ウィンドウのドロップダウン リストを使用してモデルを切り替え、次のパズルで両方のモデルをテストします (正解は 40 です)。

    ```
   I have 53 socks in my drawer: 21 identical blue, 15 identical black and 17 identical red. The lights are out, and it is completely dark. How many socks must I take out to make 100 percent certain I have at least one pair of black socks?
    ```

## モデルについて熟考する

2 つのモデルを比較しました。それらは、適切な応答を生成する能力とコストの両方の点で異なる場合があります。 どのような生成シナリオでも、実行する必要があるタスクの適合性と、処理する必要がある要求の数に対して、モデルを使用するコストのバランスが適切なモデルを見つける必要があります。

モデル カタログで提供される詳細やベンチマークと、モデルを視覚的に比較する能力は、生成 AI ソリューションの候補モデルを特定する際の出発点として役立ちます。 その後、チャット プレイグラウンドでさまざまなシステム プロンプトとユーザー プロンプトを使用して候補モデルをテストできます。

## クリーンアップ

Azure AI Foundry ポータルを確認し終わったら、不要な Azure コストが発生しないように、この演習で作成したリソースを削除する必要があります。

1. [Azure ポータル](https://portal.azure.com)を開き、この演習で使用したリソースをデプロイしたリソース グループの内容を表示します。
1. ツール バーの **[リソース グループの削除]** を選びます。
1. リソース グループ名を入力し、削除することを確認します。
